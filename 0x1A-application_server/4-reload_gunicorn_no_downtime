#!/usr/bin/env bash

# Get the PID of the Gunicorn master process
MASTER_PID=$(ps aux | grep '[g]unicorn' | awk '{print $2}')

# Print the current Gunicorn processes
echo "Before reload:"
ps aux | grep '[g]unicorn'

# Gracefully restart Gunicorn
echo "Reloading Gunicorn..."
kill -s HUP $MASTER_PID

# Wait for a few seconds to allow workers to finish processing requests
sleep 5

# Print the Gunicorn processes after reload
echo "After reload:"
ps aux | grep '[g]unicorn'
